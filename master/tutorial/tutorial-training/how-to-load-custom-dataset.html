
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How to load a custom dataset &#8212; Flair Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=87118c37" />
    <link rel="stylesheet" type="text/css" href="../../_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/main.css?v=aa1137ec" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/header.css?v=b4ed79de" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/footer.css?v=6c87b456" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/version-switcher.css?v=0d4c8916" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sidebar.css?v=c65ae207" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tutorial.css?v=a09ac9ee" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/api.css?v=67816a88" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/legal-notice.css?v=d7312f38" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/search.css?v=4a9c00e7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../../_static/documentation_options.js?v=fb952d1c"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/tutorial-training/how-to-load-custom-dataset';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Train a sequence tagger" href="how-to-train-sequence-tagger.html" />
    <link rel="prev" title="How to load a prepared dataset" href="how-to-load-prepared-dataset.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/flair_logo_white.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/flair_logo_white.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><div onclick="toggleDarkMode()" class="dark-mode-toggle" onload="applyTheme()">
    <svg width="37.009" height="37.009" viewBox="0 0 9.739 9.739" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
        <g transform="translate(-398.68 -8.4525)">
            <path d="m408.15 13.739a4.6164 4.6164 0 1 1-5.0216-5.0216 3.5905 3.5905 0 0 0 5.0216 5.0216z" class="stroke-moon" stroke-linecap="round" stroke-linejoin="round" stroke-width=".52917"/>
        </g>
    </svg>
    <svg
            width="37.00899"
            height="37.00899"
            viewBox="0 0 9.7390452 9.7390456"
            version="1.1"
            id="svg1"
            inkscape:version="1.3.2 (091e20e, 2023-11-25)"
            sodipodi:docname="sun.svg"
            xml:space="preserve"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:svg="http://www.w3.org/2000/svg">
        <sodipodi:namedview
                id="namedview1"
                pagecolor="#505050"
                bordercolor="#eeeeee"
                borderopacity="1"
                inkscape:showpageshadow="0"
                inkscape:pageopacity="0"
                inkscape:pagecheckerboard="0"
                inkscape:deskcolor="#505050"
                inkscape:document-units="px"
                inkscape:zoom="0.58541666"
                inkscape:cx="-392.02847"
                inkscape:cy="250.24911"
                inkscape:window-width="1920"
                inkscape:window-height="1011"
                inkscape:window-x="0"
                inkscape:window-y="0"
                inkscape:window-maximized="1"
                inkscape:current-layer="layer1" />
        <defs
                id="defs1">
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="367.98785"
                    height="99.33934"
                    id="rect47" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect48" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="382.71518"
                    height="121.78854"
                    id="rect49" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect50" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect51" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="385.43823"
                    height="103.11166"
                    id="rect52" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect58" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="553.33203"
                    height="91.591812"
                    id="rect59" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect60" />
        </defs>
        <g
                inkscape:label="Layer 1"
                inkscape:groupmode="layer"
                id="layer1"
                transform="translate(-398.67735,-8.3326298)">
            <path
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    d="m 403.54688,8.5869696 v 1.0650423 m 0,7.1002811 v 1.065043 m 3.26346,-7.8786503 -0.75307,0.7530733 m -5.02079,5.020787 -0.75307,0.753074 m 7.87865,-3.263467 h -1.06504 m -7.10029,0 h -1.06504 m 7.87865,3.263467 -0.75307,-0.753074 m -5.02079,-5.020787 -0.75307,-0.7530733"
                    id="path1-90"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
            <circle
                    cx="403.54688"
                    cy="13.202152"
                    r="1.7750704"
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    id="circle1"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
        </g>
    </svg>
</div>
<script defer>
    function applyTheme() {
        const theme = localStorage.getItem("theme-color");
        if (theme === "dark") {
           document.body.classList.add("dark-mode");
        } else if (theme === "light") {
           document.body.classList.remove("dark-mode");
        } else {
            if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.body.classList.add("dark-mode");
                localStorage.setItem("theme-color", "dark");
            } else {
                document.body.classList.remove("dark-mode");
                localStorage.setItem("theme-color", "light");
            }
        }
    }

    function matchPreferredScheme (e) {
        localStorage.setItem("theme-color", e.matches ? "dark" : "light");
        applyTheme();
    }

    window.addEventListener('load', applyTheme);
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', matchPreferredScheme);
    function toggleDarkMode() {
        const theme = localStorage.getItem("theme-color");
        localStorage.setItem("theme-color", theme === "dark" ? "light" : "dark");
        applyTheme();
    }
</script></div>
      
        <div class="navbar-item">
<script>
 const toggleMenu = () => {
  const elem = document.querySelector(".version-switcher__container");
  if (elem.classList.contains("open")) {
   elem.classList.remove("open");
  } else {
   elem.classList.add("open");
  }
 }
document.write(`
  <div class="version-switcher__container dropdown">
    <button onclick="toggleMenu()" id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
       latest (dev) 
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
      
    </div>
  </div>
`);
 document.querySelector('footer.bd-footer')
</script>
<style>
button.search-button {
 background-image: url("../../_static/magnifying_glass_dark.svg") !important;
}
</style></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div onclick="toggleDarkMode()" class="dark-mode-toggle" onload="applyTheme()">
    <svg width="37.009" height="37.009" viewBox="0 0 9.739 9.739" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
        <g transform="translate(-398.68 -8.4525)">
            <path d="m408.15 13.739a4.6164 4.6164 0 1 1-5.0216-5.0216 3.5905 3.5905 0 0 0 5.0216 5.0216z" class="stroke-moon" stroke-linecap="round" stroke-linejoin="round" stroke-width=".52917"/>
        </g>
    </svg>
    <svg
            width="37.00899"
            height="37.00899"
            viewBox="0 0 9.7390452 9.7390456"
            version="1.1"
            id="svg1"
            inkscape:version="1.3.2 (091e20e, 2023-11-25)"
            sodipodi:docname="sun.svg"
            xml:space="preserve"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:svg="http://www.w3.org/2000/svg">
        <sodipodi:namedview
                id="namedview1"
                pagecolor="#505050"
                bordercolor="#eeeeee"
                borderopacity="1"
                inkscape:showpageshadow="0"
                inkscape:pageopacity="0"
                inkscape:pagecheckerboard="0"
                inkscape:deskcolor="#505050"
                inkscape:document-units="px"
                inkscape:zoom="0.58541666"
                inkscape:cx="-392.02847"
                inkscape:cy="250.24911"
                inkscape:window-width="1920"
                inkscape:window-height="1011"
                inkscape:window-x="0"
                inkscape:window-y="0"
                inkscape:window-maximized="1"
                inkscape:current-layer="layer1" />
        <defs
                id="defs1">
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="367.98785"
                    height="99.33934"
                    id="rect47" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect48" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="382.71518"
                    height="121.78854"
                    id="rect49" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect50" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect51" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="385.43823"
                    height="103.11166"
                    id="rect52" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect58" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="553.33203"
                    height="91.591812"
                    id="rect59" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect60" />
        </defs>
        <g
                inkscape:label="Layer 1"
                inkscape:groupmode="layer"
                id="layer1"
                transform="translate(-398.67735,-8.3326298)">
            <path
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    d="m 403.54688,8.5869696 v 1.0650423 m 0,7.1002811 v 1.065043 m 3.26346,-7.8786503 -0.75307,0.7530733 m -5.02079,5.020787 -0.75307,0.753074 m 7.87865,-3.263467 h -1.06504 m -7.10029,0 h -1.06504 m 7.87865,3.263467 -0.75307,-0.753074 m -5.02079,-5.020787 -0.75307,-0.7530733"
                    id="path1-90"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
            <circle
                    cx="403.54688"
                    cy="13.202152"
                    r="1.7750704"
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    id="circle1"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
        </g>
    </svg>
</div>
<script defer>
    function applyTheme() {
        const theme = localStorage.getItem("theme-color");
        if (theme === "dark") {
           document.body.classList.add("dark-mode");
        } else if (theme === "light") {
           document.body.classList.remove("dark-mode");
        } else {
            if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.body.classList.add("dark-mode");
                localStorage.setItem("theme-color", "dark");
            } else {
                document.body.classList.remove("dark-mode");
                localStorage.setItem("theme-color", "light");
            }
        }
    }

    function matchPreferredScheme (e) {
        localStorage.setItem("theme-color", e.matches ? "dark" : "light");
        applyTheme();
    }

    window.addEventListener('load', applyTheme);
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', matchPreferredScheme);
    function toggleDarkMode() {
        const theme = localStorage.getItem("theme-color");
        localStorage.setItem("theme-color", theme === "dark" ? "light" : "dark");
        applyTheme();
    }
</script></div>
        
          <div class="navbar-item">
<script>
 const toggleMenu = () => {
  const elem = document.querySelector(".version-switcher__container");
  if (elem.classList.contains("open")) {
   elem.classList.remove("open");
  } else {
   elem.classList.add("open");
  }
 }
document.write(`
  <div class="version-switcher__container dropdown">
    <button onclick="toggleMenu()" id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
       latest (dev) 
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
      
    </div>
  </div>
`);
 document.querySelector('footer.bd-footer')
</script>
<style>
button.search-button {
 background-image: url("../../_static/magnifying_glass_dark.svg") !important;
}
</style></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-basics/index.html">Tutorial 1: Basic Tagging</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Tutorial 2: Training models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="how-model-training-works.html">How model training works in Flair</a></li>
<li class="toctree-l3"><a class="reference internal" href="train-vs-fine-tune.html">Training vs fine-tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-load-prepared-dataset.html">How to load a prepared dataset</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How to load a custom dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-sequence-tagger.html">Train a sequence tagger</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-text-classifier.html">Train a text classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-span-classifier.html">Train a span classifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-embeddings/index.html">Tutorial 3: Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-hunflair2/index.html">Tutorial: HunFlair2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Tutorials</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorial 2: Training models</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">How to load a custom dataset</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  


  <section id="how-to-load-a-custom-dataset">
<h1>How to load a custom dataset<a class="headerlink" href="#how-to-load-a-custom-dataset" title="Link to this heading">#</a></h1>
<p>This part of the tutorial shows how you can load a corpus for training a model.</p>
<section id="loading-a-columncorpus">
<h2>loading a ColumnCorpus<a class="headerlink" href="#loading-a-columncorpus" title="Link to this heading">#</a></h2>
<p>In cases you want to train over a sequence labeling dataset that is not in the above list, you can load them with the <a class="reference internal" href="../../api/datasets/generated/flair.datasets.sequence_labeling.ColumnCorpus.html#flair.datasets.sequence_labeling.ColumnCorpus" title="flair.datasets.sequence_labeling.ColumnCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ColumnCorpus</span></code></span></a> object.
Most sequence labeling datasets in NLP use some sort of column format in which each line is a word and each column is
one level of linguistic annotation. See for instance this sentence:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">George N B-PER</span>
<span class="go">Washington N I-PER</span>
<span class="go">went V O</span>
<span class="go">to P O</span>
<span class="go">Washington N B-LOC</span>

<span class="go">Sam N B-PER</span>
<span class="go">Houston N I-PER</span>
<span class="go">stayed V O</span>
<span class="go">home N O</span>
</pre></div>
</div>
<p>The first column is the word itself, the second coarse PoS tags, and the third BIO-annotated NER tags. Empty line separates sentences. To read such a
dataset, define the column structure as a dictionary and instantiate a <a class="reference internal" href="../../api/datasets/generated/flair.datasets.sequence_labeling.ColumnCorpus.html#flair.datasets.sequence_labeling.ColumnCorpus" title="flair.datasets.sequence_labeling.ColumnCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ColumnCorpus</span></code></span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flair.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Corpus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnCorpus</span>

<span class="c1"># define columns</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;ner&#39;</span><span class="p">}</span>

<span class="c1"># this is the folder in which train, test and dev files reside</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="s1">&#39;/path/to/data/folder&#39;</span>

<span class="c1"># init a corpus using column format, data folder and the names of the train, dev and test files</span>
<span class="n">corpus</span><span class="p">:</span> <span class="n">Corpus</span> <span class="o">=</span> <span class="n">ColumnCorpus</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span>
                              <span class="n">train_file</span><span class="o">=</span><span class="s1">&#39;train.txt&#39;</span><span class="p">,</span>
                              <span class="n">test_file</span><span class="o">=</span><span class="s1">&#39;test.txt&#39;</span><span class="p">,</span>
                              <span class="n">dev_file</span><span class="o">=</span><span class="s1">&#39;dev.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives you a <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus" title="flair.data.Corpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Corpus</span></code></span></a> object that contains the train, dev and test splits, each has a list of <a class="reference internal" href="../../api/generated/flair.data.Sentence.html#flair.data.Sentence" title="flair.data.Sentence"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Sentence</span></code></span></a>.
So, to check how many sentences there are in the training split, do</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="kp">train</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also access a sentence and check out annotations. Lets assume that the training split is
read from the example above, then executing these commands</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="kp">train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="kp">to_tagged_string</span><span class="p">(</span><span class="s1">&#39;ner&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">corpus</span><span class="o">.</span><span class="kp">train</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="kp">to_tagged_string</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>will print the sentences with different layers of annotation:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">George &lt;B-PER&gt; Washington &lt;I-PER&gt; went to Washington &lt;B-LOC&gt; .</span>

<span class="go">Sam &lt;N&gt; Houston &lt;N&gt; stayed &lt;V&gt; home &lt;N&gt;</span>
</pre></div>
</div>
</section>
<section id="reading-a-text-classification-dataset">
<h2>Reading a text classification dataset<a class="headerlink" href="#reading-a-text-classification-dataset" title="Link to this heading">#</a></h2>
<p>If you want to use your own text classification dataset, there are currently two methods to go about this:
load specified text and labels from a simple CSV file or format your data to the
<a class="reference external" href="https://fasttext.cc/docs/en/supervised-tutorial.html">FastText format</a>.</p>
<section id="load-from-simple-csv-file">
<h3>Load from simple CSV file<a class="headerlink" href="#load-from-simple-csv-file" title="Link to this heading">#</a></h3>
<p>Many text classification datasets are distributed as simple CSV files in which each row corresponds to a data point and
columns correspond to text, labels, and other metadata.  You can load a CSV format classification dataset using
<a class="reference internal" href="../../api/datasets/generated/flair.datasets.document_classification.CSVClassificationCorpus.html#flair.datasets.document_classification.CSVClassificationCorpus" title="flair.datasets.document_classification.CSVClassificationCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">CSVClassificationCorpus</span></code></span></a> by passing in a column format (like in <a class="reference internal" href="../../api/datasets/generated/flair.datasets.sequence_labeling.ColumnCorpus.html#flair.datasets.sequence_labeling.ColumnCorpus" title="flair.datasets.sequence_labeling.ColumnCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ColumnCorpus</span></code></span></a> above).  This column format indicates
which column(s) in the CSV holds the text and which field(s) the label(s). By default, Python’s CSV library assumes that
your files are in Excel CSV format, but <a class="reference external" href="https://docs.python.org/3/library/csv.html#csv-fmt-params">you can specify additional parameters</a>
if you use custom delimiters or quote characters.</p>
<p>Note: You will need to save your split CSV data files in the <code class="docutils literal notranslate"><span class="pre">data_folder</span></code> path with each file titled appropriately i.e.
<code class="docutils literal notranslate"><span class="pre">train.csv</span></code> <code class="docutils literal notranslate"><span class="pre">test.csv</span></code> <code class="docutils literal notranslate"><span class="pre">dev.csv</span></code>.   This is because the corpus initializers will automatically search for the train,
dev, test splits in a folder.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flair.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Corpus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVClassificationCorpus</span>

<span class="c1"># this is the folder in which train, test and dev files reside</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="s1">&#39;/path/to/data&#39;</span>

<span class="c1"># column format indicating which columns hold the text and label(s)</span>
<span class="n">column_name_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;label_topic&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;label_subtopic&quot;</span><span class="p">}</span>

<span class="c1"># load corpus containing training, test and dev data and if CSV has a header, you can skip it</span>
<span class="n">corpus</span><span class="p">:</span> <span class="n">Corpus</span> <span class="o">=</span> <span class="n">CSVClassificationCorpus</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span>
                                         <span class="n">column_name_map</span><span class="p">,</span>
                                         <span class="n">skip_header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>    <span class="c1"># tab-separated files</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fasttext-format">
<h3>FastText format<a class="headerlink" href="#fasttext-format" title="Link to this heading">#</a></h3>
<p>If using <a class="reference internal" href="../../api/datasets/generated/flair.datasets.document_classification.CSVClassificationCorpus.html#flair.datasets.document_classification.CSVClassificationCorpus" title="flair.datasets.document_classification.CSVClassificationCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">CSVClassificationCorpus</span></code></span></a> is not practical, you may format your data to the FastText format, in which each line in the file represents a text document. A document can have one or multiple labels that are defined at the beginning of the line starting with the prefix <code class="docutils literal notranslate"><span class="pre">__label__</span></code>. This looks like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>__label__&lt;label_1&gt;<span class="w"> </span>&lt;text&gt;
__label__&lt;label_1&gt;<span class="w"> </span>__label__&lt;label_2&gt;<span class="w"> </span>&lt;text&gt;
</pre></div>
</div>
<p>As previously mentioned, to create a <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus" title="flair.data.Corpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Corpus</span></code></span></a> for a text classification task, you need to have three files (train, dev, and test) in the
above format located in one folder. This data folder structure could, for example, look like this for the IMDB task:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/resources/tasks/imdb/train.txt
/resources/tasks/imdb/dev.txt
/resources/tasks/imdb/test.txt
</pre></div>
</div>
<p>Now create a <a class="reference internal" href="../../api/datasets/generated/flair.datasets.document_classification.CSVClassificationCorpus.html#flair.datasets.document_classification.CSVClassificationCorpus" title="flair.datasets.document_classification.CSVClassificationCorpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">CSVClassificationCorpus</span></code></span></a> by pointing to this folder (<code class="docutils literal notranslate"><span class="pre">/resources/tasks/imdb</span></code>).
Thereby, each line in a file is converted to a <a class="reference internal" href="../../api/generated/flair.data.Sentence.html#flair.data.Sentence" title="flair.data.Sentence"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Sentence</span></code></span></a> object annotated with the labels.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>A text in a line can have multiple sentences. Thus, a <a class="reference internal" href="../../api/generated/flair.data.Sentence.html#flair.data.Sentence" title="flair.data.Sentence"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Sentence</span></code></span></a> object can actually consist of multiple sentences.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flair.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">Corpus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassificationCorpus</span>

<span class="c1"># this is the folder in which train, test and dev files reside</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="s1">&#39;/path/to/data/folder&#39;</span>

<span class="c1"># load corpus containing training, test and dev data</span>
<span class="n">corpus</span><span class="p">:</span> <span class="n">Corpus</span> <span class="o">=</span> <span class="n">ClassificationCorpus</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span>
                                      <span class="n">test_file</span><span class="o">=</span><span class="s1">&#39;test.txt&#39;</span><span class="p">,</span>
                                      <span class="n">dev_file</span><span class="o">=</span><span class="s1">&#39;dev.txt&#39;</span><span class="p">,</span>
                                      <span class="n">train_file</span><span class="o">=</span><span class="s1">&#39;train.txt&#39;</span><span class="p">,</span>
                                      <span class="kp">label_type</span><span class="o">=</span><span class="s1">&#39;topic&#39;</span><span class="p">,</span>
                                      <span class="p">)</span>
</pre></div>
</div>
<p>Note again that our corpus initializers have methods to automatically look for train, dev and test splits in a folder. So in
most cases you don’t need to specify the file names yourself. Often, this is enough:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the folder in which train, test and dev files reside</span>
<span class="n">data_folder</span> <span class="o">=</span> <span class="s1">&#39;/path/to/data/folder&#39;</span>

<span class="c1"># load corpus by pointing to folder. Train, dev and test gets identified automatically.</span>
<span class="n">corpus</span><span class="p">:</span> <span class="n">Corpus</span> <span class="o">=</span> <span class="n">ClassificationCorpus</span><span class="p">(</span><span class="n">data_folder</span><span class="p">,</span>
                                      <span class="kp">label_type</span><span class="o">=</span><span class="s1">&#39;topic&#39;</span><span class="p">,</span>
                                      <span class="p">)</span>
</pre></div>
</div>
<p>Since the FastText format does not have columns, you must manually define a name for the annotations. In this
example we chose <code class="docutils literal notranslate"><span class="pre">label_type='topic'</span></code> to denote that we are loading a corpus with topic labels.</p>
</section>
</section>
<section id="next">
<h2>Next<a class="headerlink" href="#next" title="Link to this heading">#</a></h2>
<p>Next, learn <a class="reference internal" href="how-to-train-sequence-tagger.html"><span class="std std-doc">how to train a sequence tagger</span></a>.</p>
</section>
</section>



                </article>
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023 Alan Akbik.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><a href="../../legal-notice/index.html">Legal notice</a></div>
      
        <div class="footer-item"><a href="https://twitter.com/alan_akbik" target="_blank">Twitter/X</a></div>
      
        <div class="footer-item"><a href="https://www.linkedin.com/in/alan-akbik-9859b1122/" target="_blank">LinkedIn</a></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>