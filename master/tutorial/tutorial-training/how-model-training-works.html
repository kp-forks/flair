
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How model training works in Flair &#8212; Flair Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=87118c37" />
    <link rel="stylesheet" type="text/css" href="../../_static/github_style.css?v=1093691d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/main.css?v=aa1137ec" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/header.css?v=b4ed79de" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/footer.css?v=6c87b456" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/version-switcher.css?v=0d4c8916" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/sidebar.css?v=c65ae207" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tutorial.css?v=a09ac9ee" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/api.css?v=67816a88" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/legal-notice.css?v=d7312f38" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/search.css?v=4a9c00e7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script src="../../_static/documentation_options.js?v=fb952d1c"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorial/tutorial-training/how-model-training-works';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Training vs fine-tuning" href="train-vs-fine-tune.html" />
    <link rel="prev" title="Tutorial 2: Training models" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/flair_logo_white.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/flair_logo_white.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><div onclick="toggleDarkMode()" class="dark-mode-toggle" onload="applyTheme()">
    <svg width="37.009" height="37.009" viewBox="0 0 9.739 9.739" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
        <g transform="translate(-398.68 -8.4525)">
            <path d="m408.15 13.739a4.6164 4.6164 0 1 1-5.0216-5.0216 3.5905 3.5905 0 0 0 5.0216 5.0216z" class="stroke-moon" stroke-linecap="round" stroke-linejoin="round" stroke-width=".52917"/>
        </g>
    </svg>
    <svg
            width="37.00899"
            height="37.00899"
            viewBox="0 0 9.7390452 9.7390456"
            version="1.1"
            id="svg1"
            inkscape:version="1.3.2 (091e20e, 2023-11-25)"
            sodipodi:docname="sun.svg"
            xml:space="preserve"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:svg="http://www.w3.org/2000/svg">
        <sodipodi:namedview
                id="namedview1"
                pagecolor="#505050"
                bordercolor="#eeeeee"
                borderopacity="1"
                inkscape:showpageshadow="0"
                inkscape:pageopacity="0"
                inkscape:pagecheckerboard="0"
                inkscape:deskcolor="#505050"
                inkscape:document-units="px"
                inkscape:zoom="0.58541666"
                inkscape:cx="-392.02847"
                inkscape:cy="250.24911"
                inkscape:window-width="1920"
                inkscape:window-height="1011"
                inkscape:window-x="0"
                inkscape:window-y="0"
                inkscape:window-maximized="1"
                inkscape:current-layer="layer1" />
        <defs
                id="defs1">
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="367.98785"
                    height="99.33934"
                    id="rect47" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect48" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="382.71518"
                    height="121.78854"
                    id="rect49" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect50" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect51" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="385.43823"
                    height="103.11166"
                    id="rect52" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect58" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="553.33203"
                    height="91.591812"
                    id="rect59" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect60" />
        </defs>
        <g
                inkscape:label="Layer 1"
                inkscape:groupmode="layer"
                id="layer1"
                transform="translate(-398.67735,-8.3326298)">
            <path
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    d="m 403.54688,8.5869696 v 1.0650423 m 0,7.1002811 v 1.065043 m 3.26346,-7.8786503 -0.75307,0.7530733 m -5.02079,5.020787 -0.75307,0.753074 m 7.87865,-3.263467 h -1.06504 m -7.10029,0 h -1.06504 m 7.87865,3.263467 -0.75307,-0.753074 m -5.02079,-5.020787 -0.75307,-0.7530733"
                    id="path1-90"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
            <circle
                    cx="403.54688"
                    cy="13.202152"
                    r="1.7750704"
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    id="circle1"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
        </g>
    </svg>
</div>
<script defer>
    function applyTheme() {
        const theme = localStorage.getItem("theme-color");
        if (theme === "dark") {
           document.body.classList.add("dark-mode");
        } else if (theme === "light") {
           document.body.classList.remove("dark-mode");
        } else {
            if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.body.classList.add("dark-mode");
                localStorage.setItem("theme-color", "dark");
            } else {
                document.body.classList.remove("dark-mode");
                localStorage.setItem("theme-color", "light");
            }
        }
    }

    function matchPreferredScheme (e) {
        localStorage.setItem("theme-color", e.matches ? "dark" : "light");
        applyTheme();
    }

    window.addEventListener('load', applyTheme);
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', matchPreferredScheme);
    function toggleDarkMode() {
        const theme = localStorage.getItem("theme-color");
        localStorage.setItem("theme-color", theme === "dark" ? "light" : "dark");
        applyTheme();
    }
</script></div>
      
        <div class="navbar-item">
<script>
 const toggleMenu = () => {
  const elem = document.querySelector(".version-switcher__container");
  if (elem.classList.contains("open")) {
   elem.classList.remove("open");
  } else {
   elem.classList.add("open");
  }
 }
document.write(`
  <div class="version-switcher__container dropdown">
    <button onclick="toggleMenu()" id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
       latest (dev) 
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
      
    </div>
  </div>
`);
 document.querySelector('footer.bd-footer')
</script>
<style>
button.search-button {
 background-image: url("../../_static/magnifying_glass_dark.svg") !important;
}
</style></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing/index.html">
                        Contributing
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><div onclick="toggleDarkMode()" class="dark-mode-toggle" onload="applyTheme()">
    <svg width="37.009" height="37.009" viewBox="0 0 9.739 9.739" xml:space="preserve" xmlns="http://www.w3.org/2000/svg">
        <g transform="translate(-398.68 -8.4525)">
            <path d="m408.15 13.739a4.6164 4.6164 0 1 1-5.0216-5.0216 3.5905 3.5905 0 0 0 5.0216 5.0216z" class="stroke-moon" stroke-linecap="round" stroke-linejoin="round" stroke-width=".52917"/>
        </g>
    </svg>
    <svg
            width="37.00899"
            height="37.00899"
            viewBox="0 0 9.7390452 9.7390456"
            version="1.1"
            id="svg1"
            inkscape:version="1.3.2 (091e20e, 2023-11-25)"
            sodipodi:docname="sun.svg"
            xml:space="preserve"
            xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
            xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:svg="http://www.w3.org/2000/svg">
        <sodipodi:namedview
                id="namedview1"
                pagecolor="#505050"
                bordercolor="#eeeeee"
                borderopacity="1"
                inkscape:showpageshadow="0"
                inkscape:pageopacity="0"
                inkscape:pagecheckerboard="0"
                inkscape:deskcolor="#505050"
                inkscape:document-units="px"
                inkscape:zoom="0.58541666"
                inkscape:cx="-392.02847"
                inkscape:cy="250.24911"
                inkscape:window-width="1920"
                inkscape:window-height="1011"
                inkscape:window-x="0"
                inkscape:window-y="0"
                inkscape:window-maximized="1"
                inkscape:current-layer="layer1" />
        <defs
                id="defs1">
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="367.98785"
                    height="99.33934"
                    id="rect47" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect48" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="382.71518"
                    height="121.78854"
                    id="rect49" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect50" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect51" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="385.43823"
                    height="103.11166"
                    id="rect52" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect58" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="553.33203"
                    height="91.591812"
                    id="rect59" />
            <rect
                    x="203.51459"
                    y="1150.095"
                    width="433.75299"
                    height="97.631157"
                    id="rect60" />
        </defs>
        <g
                inkscape:label="Layer 1"
                inkscape:groupmode="layer"
                id="layer1"
                transform="translate(-398.67735,-8.3326298)">
            <path
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    d="m 403.54688,8.5869696 v 1.0650423 m 0,7.1002811 v 1.065043 m 3.26346,-7.8786503 -0.75307,0.7530733 m -5.02079,5.020787 -0.75307,0.753074 m 7.87865,-3.263467 h -1.06504 m -7.10029,0 h -1.06504 m 7.87865,3.263467 -0.75307,-0.753074 m -5.02079,-5.020787 -0.75307,-0.7530733"
                    id="path1-90"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
            <circle
                    cx="403.54688"
                    cy="13.202152"
                    r="1.7750704"
                    fill="none"
                    stroke-linecap="round"
                    stroke-miterlimit="10"
                    stroke-width="32"
                    id="circle1"
                    style="stroke:#ffffff;stroke-width:0.50868;stroke-dasharray:none;stroke-opacity:1" />
        </g>
    </svg>
</div>
<script defer>
    function applyTheme() {
        const theme = localStorage.getItem("theme-color");
        if (theme === "dark") {
           document.body.classList.add("dark-mode");
        } else if (theme === "light") {
           document.body.classList.remove("dark-mode");
        } else {
            if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
                document.body.classList.add("dark-mode");
                localStorage.setItem("theme-color", "dark");
            } else {
                document.body.classList.remove("dark-mode");
                localStorage.setItem("theme-color", "light");
            }
        }
    }

    function matchPreferredScheme (e) {
        localStorage.setItem("theme-color", e.matches ? "dark" : "light");
        applyTheme();
    }

    window.addEventListener('load', applyTheme);
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', matchPreferredScheme);
    function toggleDarkMode() {
        const theme = localStorage.getItem("theme-color");
        localStorage.setItem("theme-color", theme === "dark" ? "light" : "dark");
        applyTheme();
    }
</script></div>
        
          <div class="navbar-item">
<script>
 const toggleMenu = () => {
  const elem = document.querySelector(".version-switcher__container");
  if (elem.classList.contains("open")) {
   elem.classList.remove("open");
  } else {
   elem.classList.add("open");
  }
 }
document.write(`
  <div class="version-switcher__container dropdown">
    <button onclick="toggleMenu()" id="versionswitcherbutton" type="button" role="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="listbox" aria-controls="versionswitcherlist" aria-label="Version switcher list">
       latest (dev) 
    </button>
    <div id="versionswitcherlist" class="version-switcher__menu dropdown-menu list-group-flush py-0" role="listbox" aria-labelledby="versionswitcherbutton">
    <!-- dropdown will be populated by javascript on page load -->
      
    </div>
  </div>
`);
 document.querySelector('footer.bd-footer')
</script>
<style>
button.search-button {
 background-image: url("../../_static/magnifying_glass_dark.svg") !important;
}
</style></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-basics/index.html">Tutorial 1: Basic Tagging</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Tutorial 2: Training models</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">How model training works in Flair</a></li>
<li class="toctree-l3"><a class="reference internal" href="train-vs-fine-tune.html">Training vs fine-tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-load-prepared-dataset.html">How to load a prepared dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-load-custom-dataset.html">How to load a custom dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-sequence-tagger.html">Train a sequence tagger</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-text-classifier.html">Train a text classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="how-to-train-span-classifier.html">Train a span classifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-embeddings/index.html">Tutorial 3: Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial-hunflair2/index.html">Tutorial: HunFlair2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
</div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Tutorials</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorial 2: Training models</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">How model training works in Flair</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  


  <section id="how-model-training-works-in-flair">
<h1>How model training works in Flair<a class="headerlink" href="#how-model-training-works-in-flair" title="Link to this heading">#</a></h1>
<p>In this section, we explain the main ideas of model training in Flair.</p>
<p>In particular, we give an introduction to the <a class="reference internal" href="../../api/generated/flair.trainers.ModelTrainer.html#flair.trainers.ModelTrainer" title="flair.trainers.ModelTrainer"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ModelTrainer</span></code></span></a> class, and discuss what decisions you have to make to train good models.</p>
<section id="example-training-a-part-of-speech-tagger">
<h2>Example: Training a Part-of-Speech Tagger<a class="headerlink" href="#example-training-a-part-of-speech-tagger" title="Link to this heading">#</a></h2>
<p>As example in this chapter, we train a simple part-of-speech tagger for English. To make the example run fast</p>
<ul class="simple">
<li><p>we downsample the training data to 10%</p></li>
<li><p>we use only simple classic word embeddings (gloVe)</p></li>
</ul>
<p>Here is the full training code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flair.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">UD_ENGLISH</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">WordEmbeddings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequenceTagger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flair.trainers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelTrainer</span>

<span class="c1"># 1. load the corpus</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">UD_ENGLISH</span><span class="p">()</span><span class="o">.</span><span class="kp">downsample</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>

<span class="c1"># 2. what label do we want to predict?</span>
<span class="kp">label_type</span> <span class="o">=</span> <span class="s1">&#39;upos&#39;</span>

<span class="c1"># 3. make the label dictionary from the corpus</span>
<span class="n">label_dict</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="kp">make_label_dictionary</span><span class="p">(</span><span class="kp">label_type</span><span class="o">=</span><span class="kp">label_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">label_dict</span><span class="p">)</span>

<span class="c1"># 4. initialize embeddings</span>
<span class="n">embeddings</span> <span class="o">=</span> <span class="n">WordEmbeddings</span><span class="p">(</span><span class="s1">&#39;glove&#39;</span><span class="p">)</span>

<span class="c1"># 5. initialize sequence tagger</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SequenceTagger</span><span class="p">(</span><span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                        <span class="n">embeddings</span><span class="o">=</span><span class="n">embeddings</span><span class="p">,</span>
                        <span class="n">tag_dictionary</span><span class="o">=</span><span class="n">label_dict</span><span class="p">,</span>
                        <span class="n">tag_type</span><span class="o">=</span><span class="kp">label_type</span><span class="p">)</span>

<span class="c1"># 6. initialize trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>

<span class="c1"># 7. start training</span>
<span class="n">trainer</span><span class="o">.</span><span class="kp">train</span><span class="p">(</span><span class="s1">&#39;resources/taggers/example-upos&#39;</span><span class="p">,</span>
              <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
              <span class="n">mini_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
              <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This code (1) loads the English universal dependencies dataset as training corpus, (2) create a label dictionary for universal part-of-speech tags from the corpus, (3) initializes embeddings and (4) runs the trainer for 10 epochs.</p>
<p>Running this script should produce output that looks like this during training:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">014</span> <span class="o">----------------------------------------------------------------------------------------------------</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">016</span> <span class="n">Model</span> <span class="n">training</span> <span class="n">base</span> <span class="n">path</span><span class="p">:</span> <span class="s2">&quot;resources/taggers/example-upos&quot;</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">017</span> <span class="o">----------------------------------------------------------------------------------------------------</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">020</span> <span class="n">Device</span><span class="p">:</span> <span class="kp">cuda</span><span class="p">:</span><span class="mi">0</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">022</span> <span class="o">----------------------------------------------------------------------------------------------------</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">023</span> <span class="n">Embeddings</span> <span class="kp">storage</span> <span class="n">mode</span><span class="p">:</span> <span class="kp">cpu</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">38</span><span class="p">,</span><span class="mi">025</span> <span class="o">----------------------------------------------------------------------------------------------------</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">39</span><span class="p">,</span><span class="mi">128</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">4</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">3.28409882</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">1.10</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">2611.84</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">39</span><span class="p">,</span><span class="mi">474</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">8</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">3.13510367</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">1.45</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">3143.21</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">39</span><span class="p">,</span><span class="mi">910</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">12</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">3.02619775</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">1.88</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">3434.39</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">167</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">16</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.95288554</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">2.14</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">3783.76</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">504</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">20</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.86820018</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">2.48</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">4171.22</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">843</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">24</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.80507526</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">2.82</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">4557.72</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">118</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">28</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.74217397</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">3.09</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">4878.00</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">420</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">32</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.69161746</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">3.39</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">5072.93</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">705</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">36</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.63837577</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">3.68</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">5260.02</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">972</span> <span class="n">epoch</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">iter</span> <span class="mi">40</span><span class="o">/</span><span class="mi">40</span> <span class="o">-</span> <span class="n">loss</span> <span class="mf">2.58915523</span> <span class="o">-</span> <span class="n">time</span> <span class="p">(</span><span class="n">sec</span><span class="p">):</span> <span class="mf">3.95</span> <span class="o">-</span> <span class="n">samples</span><span class="o">/</span><span class="n">sec</span><span class="p">:</span> <span class="mf">5394.33</span> <span class="o">-</span> <span class="n">lr</span><span class="p">:</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">975</span> <span class="o">----------------------------------------------------------------------------------------------------</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span><span class="mi">977</span> <span class="n">EPOCH</span> <span class="mi">1</span> <span class="n">done</span><span class="p">:</span> <span class="n">loss</span> <span class="mf">2.5892</span> <span class="o">-</span> <span class="n">lr</span> <span class="mf">0.100000</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">567</span> <span class="n">DEV</span> <span class="p">:</span> <span class="n">loss</span> <span class="mf">2.009714126586914</span> <span class="o">-</span> <span class="n">f1</span><span class="o">-</span><span class="n">score</span> <span class="p">(</span><span class="n">micro</span> <span class="n">avg</span><span class="p">)</span>  <span class="mf">0.41</span>
<span class="mi">2023</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span> <span class="mi">17</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">579</span> <span class="n">BAD</span> <span class="n">EPOCHS</span> <span class="p">(</span><span class="n">no</span> <span class="n">improvement</span><span class="p">):</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The output monitors the loss over the epochs. At the end of each epoch, the development score is computed and printed.</p>
<p>And a <strong>final evaluation report</strong> gets printed in the end:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Results</span><span class="p">:</span>
<span class="o">-</span> <span class="n">F</span><span class="o">-</span><span class="n">score</span> <span class="p">(</span><span class="n">micro</span><span class="p">)</span> <span class="mf">0.7732</span>
<span class="o">-</span> <span class="n">F</span><span class="o">-</span><span class="n">score</span> <span class="p">(</span><span class="n">macro</span><span class="p">)</span> <span class="mf">0.6329</span>
<span class="o">-</span> <span class="n">Accuracy</span> <span class="mf">0.7732</span>

<span class="n">By</span> <span class="n">class</span><span class="p">:</span>
              <span class="n">precision</span>    <span class="n">recall</span>  <span class="n">f1</span><span class="o">-</span><span class="n">score</span>   <span class="n">support</span>

        <span class="n">NOUN</span>     <span class="mf">0.7199</span>    <span class="mf">0.7199</span>    <span class="mf">0.7199</span>       <span class="mi">407</span>
       <span class="n">PUNCT</span>     <span class="mf">0.9263</span>    <span class="mf">0.9843</span>    <span class="mf">0.9544</span>       <span class="mi">319</span>
        <span class="n">VERB</span>     <span class="mf">0.7521</span>    <span class="mf">0.6938</span>    <span class="mf">0.7218</span>       <span class="mi">258</span>
        <span class="n">PRON</span>     <span class="mf">0.7782</span>    <span class="mf">0.9300</span>    <span class="mf">0.8474</span>       <span class="mi">200</span>
         <span class="n">ADP</span>     <span class="mf">0.8559</span>    <span class="mf">0.9515</span>    <span class="mf">0.9011</span>       <span class="mi">206</span>
       <span class="n">PROPN</span>     <span class="mf">0.6585</span>    <span class="mf">0.6398</span>    <span class="mf">0.6490</span>       <span class="mi">211</span>
         <span class="n">ADJ</span>     <span class="mf">0.5654</span>    <span class="mf">0.6914</span>    <span class="mf">0.6221</span>       <span class="mi">175</span>
         <span class="n">DET</span>     <span class="mf">0.9572</span>    <span class="mf">0.8995</span>    <span class="mf">0.9275</span>       <span class="mi">199</span>
         <span class="n">AUX</span>     <span class="mf">0.8609</span>    <span class="mf">0.8784</span>    <span class="mf">0.8696</span>       <span class="mi">148</span>
         <span class="n">ADV</span>     <span class="mf">0.5052</span>    <span class="mf">0.5000</span>    <span class="mf">0.5026</span>        <span class="mi">98</span>
       <span class="n">CCONJ</span>     <span class="mf">0.9833</span>    <span class="mf">0.9077</span>    <span class="mf">0.9440</span>        <span class="mi">65</span>
         <span class="n">NUM</span>     <span class="mf">0.5435</span>    <span class="mf">0.3289</span>    <span class="mf">0.4098</span>        <span class="mi">76</span>
        <span class="n">PART</span>     <span class="mf">0.9091</span>    <span class="mf">0.7143</span>    <span class="mf">0.8000</span>        <span class="mi">56</span>
       <span class="n">SCONJ</span>     <span class="mf">0.7083</span>    <span class="mf">0.5667</span>    <span class="mf">0.6296</span>        <span class="mi">30</span>
         <span class="n">SYM</span>     <span class="mf">0.3333</span>    <span class="mf">0.2143</span>    <span class="mf">0.2609</span>        <span class="mi">14</span>
           <span class="n">X</span>     <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>        <span class="mi">15</span>
        <span class="n">INTJ</span>     <span class="mf">0.0000</span>    <span class="mf">0.0000</span>    <span class="mf">0.0000</span>        <span class="mi">14</span>

    <span class="n">accuracy</span>                         <span class="mf">0.7732</span>      <span class="mi">2491</span>
   <span class="n">macro</span> <span class="n">avg</span>     <span class="mf">0.6504</span>    <span class="mf">0.6247</span>    <span class="mf">0.6329</span>      <span class="mi">2491</span>
<span class="n">weighted</span> <span class="n">avg</span>     <span class="mf">0.7635</span>    <span class="mf">0.7732</span>    <span class="mf">0.7655</span>      <span class="mi">2491</span>
</pre></div>
</div>
<p>This report gives us a breakdown of the precision, recall and F1 score of all classes, as well as overall.</p>
<p>Congrats, you just trained your first model!</p>
</section>
<section id="step-by-step-walkthrough">
<h2>Step-by-step walkthrough<a class="headerlink" href="#step-by-step-walkthrough" title="Link to this heading">#</a></h2>
<p>The above code showed you how to train a part-of-speech tagger.</p>
<p>Now let’s individually look at each of the main steps in the above script:</p>
<section id="step-1-load-a-corpus">
<h3>Step 1: Load a Corpus<a class="headerlink" href="#step-1-load-a-corpus" title="Link to this heading">#</a></h3>
<p>The first thing you need is data to train and evaluate your model on.</p>
<p>In Flair, training is done using the <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus" title="flair.data.Corpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Corpus</span></code></span></a> object that holds three “splits”: a <code class="docutils literal notranslate"><span class="pre">train</span></code>, a <code class="docutils literal notranslate"><span class="pre">dev</span></code> and a <code class="docutils literal notranslate"><span class="pre">test</span></code> split.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Splitting your data into three splits is standard procedure in machine learning: the <code class="docutils literal notranslate"><span class="pre">train</span></code> split is used to train the model while the <code class="docutils literal notranslate"><span class="pre">dev</span></code> split is used for model selection and early stopping. The <code class="docutils literal notranslate"><span class="pre">test</span></code> split is used only for the final evaluation.</p>
</div>
<p>In this example, we use the <a class="reference external" href="https://universaldependencies.org/treebanks/en_ewt/index.html">English Universal Dependencies</a> dataset to train on. It contains many sentences fully annotated with both universal and language-specific part-of-speech tags. Running these lines will load and print the corpus:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">flair.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">UD_ENGLISH</span>

<span class="c1"># 1. load the corpus</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">UD_ENGLISH</span><span class="p">()</span><span class="o">.</span><span class="kp">downsample</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
</pre></div>
</div>
<p>which should print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Corpus</span><span class="p">:</span> <span class="mi">1254</span> <span class="kp">train</span> <span class="o">+</span> <span class="mi">200</span> <span class="n">dev</span> <span class="o">+</span> <span class="mi">208</span> <span class="n">test</span> <span class="n">sentences</span>
</pre></div>
</div>
<p>Showing us that our downsampled training data has three splits: a training split of 1254 sentences, a dev split of 200 sentences, and a test split of 208 sentences.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus" title="flair.data.Corpus"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">Corpus</span></code></span></a> object has a number of very handy helper functions that let you manipulate the data and compute statistics. For instance, in the code above we called <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus.downsample" title="flair.data.Corpus.downsample"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">Corpus.downsample(0.1)</span></code></span></a> to downsample the corpus to 10% of its original size. To learn about more helper functions, check out the <a class="reference internal" href="how-to-load-prepared-dataset.html"><span class="std std-doc">corpus tutorial</span></a>.</p>
</div>
</section>
<section id="step-2-choose-the-label-type">
<h3>Step 2: Choose the label type<a class="headerlink" href="#step-2-choose-the-label-type" title="Link to this heading">#</a></h3>
<p>After you load the corpus, you need to decide which label type to predict.</p>
<p>We choose the label type <strong>‘upos’</strong>, since we want to predict universal part-of-speech tags in this example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2. what label do we want to predict?</span>
<span class="kp">label_type</span> <span class="o">=</span> <span class="s1">&#39;upos&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You might ask: why is specifying the <code class="docutils literal notranslate"><span class="pre">label_type</span></code> even necessary? Well, some corpora have more than one label type. The English UD treebank for instance has both universal PoS tags (‘upos’) and regular PoS tags (‘pos’), plus many other layers of annotation. A tagger is normally trained to predict just type of annotation.</p>
<p>This means that you need to know which label types a specific corpus has labels for, and choose one of them.</p>
</div>
</section>
<section id="step-3-creating-a-label-dictionary">
<h3>Step 3: Creating a label dictionary<a class="headerlink" href="#step-3-creating-a-label-dictionary" title="Link to this heading">#</a></h3>
<p>Our model needs to predict a set of labels. To determine the label set, run <a class="reference internal" href="../../api/generated/flair.data.Corpus.html#flair.data.Corpus.make_label_dictionary" title="flair.data.Corpus.make_label_dictionary"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">Corpus.make_label_dictionary()</span></code></span></a> on the corpus and pass the label type you want to predict. In this example, we pass <strong>‘upos’</strong> since we want to predict universal part-of-speech tags.</p>
<p>Running these lines will compute and print the label dictionary from the corpus:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 3. make the label dictionary from the corpus</span>
<span class="n">label_dict</span> <span class="o">=</span> <span class="n">corpus</span><span class="o">.</span><span class="kp">make_label_dictionary</span><span class="p">(</span><span class="kp">label_type</span><span class="o">=</span><span class="kp">label_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">label_dict</span><span class="p">)</span>
</pre></div>
</div>
<p>which should print:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dictionary</span> <span class="k">with</span> <span class="mi">18</span> <span class="n">tags</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">unk</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">NOUN</span><span class="p">,</span> <span class="n">PUNCT</span><span class="p">,</span> <span class="n">VERB</span><span class="p">,</span> <span class="n">PRON</span><span class="p">,</span> <span class="n">ADP</span><span class="p">,</span> <span class="n">DET</span><span class="p">,</span> <span class="n">AUX</span><span class="p">,</span> <span class="n">ADJ</span><span class="p">,</span> <span class="n">PROPN</span><span class="p">,</span> <span class="n">ADV</span><span class="p">,</span> <span class="n">CCONJ</span><span class="p">,</span> <span class="n">PART</span><span class="p">,</span> <span class="n">SCONJ</span><span class="p">,</span> <span class="n">NUM</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">SYM</span><span class="p">,</span> <span class="n">INTJ</span>
</pre></div>
</div>
<p>Showing us that our label dictionary has 18 PoS tags, including one generic tag (<code class="docutils literal notranslate"><span class="pre">&lt;unk&gt;</span></code>) for all unknown labels.</p>
</section>
<section id="step-4-initialize-embeddings">
<h3>Step 4: Initialize embeddings<a class="headerlink" href="#step-4-initialize-embeddings" title="Link to this heading">#</a></h3>
<p>All models in Flair require you to choose embeddings. In most cases, you’ll want transformer embeddings. Choosing the right embeddings and parameters is crucial in order to train good models.</p>
<p>In our example, we use simple GloVe embeddings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 4. initialize embeddings</span>
<span class="n">embeddings</span> <span class="o">=</span> <span class="n">WordEmbeddings</span><span class="p">(</span><span class="s1">&#39;glove&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>But this is only to make the example code run fast. We generally advise to use transformer-based embeddings instead.</p>
</section>
<section id="step-5-initialize-the-model">
<h3>Step 5: Initialize the Model<a class="headerlink" href="#step-5-initialize-the-model" title="Link to this heading">#</a></h3>
<p>Depending on what you want to do, you need to initialize the appropriate model type.</p>
<p>For this example, we use the <a class="reference internal" href="../../api/generated/flair.models.SequenceTagger.html#flair.models.SequenceTagger" title="flair.models.SequenceTagger"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">SequenceTagger</span></code></span></a> since we do part-of-speech tagging:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5. initialize sequence tagger</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SequenceTagger</span><span class="p">(</span><span class="n">hidden_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                       <span class="n">embeddings</span><span class="o">=</span><span class="n">embeddings</span><span class="p">,</span>
                       <span class="n">tag_dictionary</span><span class="o">=</span><span class="n">label_dict</span><span class="p">,</span>
                       <span class="n">tag_type</span><span class="o">=</span><span class="kp">label_type</span><span class="p">)</span>
</pre></div>
</div>
<p>Printing it will give you the PyTorch model that is initialized.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on the task, you need a different model type: For sequence labeling (NER, part-of-speech tagging) you need the <a class="reference internal" href="../../api/generated/flair.models.SequenceTagger.html#flair.models.SequenceTagger" title="flair.models.SequenceTagger"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">SequenceTagger</span></code></span></a>. For text classification you need the <a class="reference internal" href="../../api/generated/flair.models.TextClassifier.html#flair.models.TextClassifier" title="flair.models.TextClassifier"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">TextClassifier</span></code></span></a>.</p>
<p>For each model type, we are creating dedicated tutorials to better explain what they do.</p>
</div>
</section>
<section id="step-6-initialize-the-trainer">
<h3>Step 6: Initialize the Trainer<a class="headerlink" href="#step-6-initialize-the-trainer" title="Link to this heading">#</a></h3>
<p>The <a class="reference internal" href="../../api/generated/flair.trainers.ModelTrainer.html#flair.trainers.ModelTrainer" title="flair.trainers.ModelTrainer"><span class="xref myst py py-class"><code class="docutils literal notranslate"><span class="pre">ModelTrainer</span></code></span></a> is initialized simply by passing the model and the corpus because that is all it needs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6. initialize trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">corpus</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-7-train">
<h3>Step 7: Train<a class="headerlink" href="#step-7-train" title="Link to this heading">#</a></h3>
<p>Once the trainer is initialized, you can call <a class="reference internal" href="../../api/generated/flair.trainers.ModelTrainer.html#flair.trainers.ModelTrainer.train" title="flair.trainers.ModelTrainer.train"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">ModelTrainer.train()</span></code></span></a> to launch a standard training run.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 7. start training</span>
<span class="n">trainer</span><span class="o">.</span><span class="kp">train</span><span class="p">(</span><span class="s1">&#39;resources/taggers/example-upos&#39;</span><span class="p">,</span>
              <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
              <span class="n">mini_batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
              <span class="n">max_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This will launch a “standard training run” with SGD as optimizer. By default, the learning rate is annealed against the development score: if for 3 epochs there is no improvement on the dev split, the learning rate is halved. If this happens too often, the learning rate will fall below a minimal threshold and training stops early.</p>
<p>The max_epochs parameter is set to a small number in this script to make it run fast, but normally you should use a much higher value (150 or 200).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are two main mechanisms to train a model in Flair. (1) The “classic” workflow (SGD with annealing) is invoked as above using the <a class="reference internal" href="../../api/generated/flair.trainers.ModelTrainer.html#flair.trainers.ModelTrainer.train" title="flair.trainers.ModelTrainer.train"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">ModelTrainer.train()</span></code></span></a> method. (2) The current state-of-the-art based on fine-tuning (AdamW with Linear Learning Rate Schedulle) is invoked using the <a class="reference internal" href="../../api/generated/flair.trainers.ModelTrainer.html#flair.trainers.ModelTrainer.fine_tune" title="flair.trainers.ModelTrainer.fine_tune"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">ModelTrainer.fine_tune()</span></code></span></a> method. In most cases, you will want to use the latter.</p>
</div>
</section>
<section id="step-8-predict">
<h3>Step 8: Predict<a class="headerlink" href="#step-8-predict" title="Link to this heading">#</a></h3>
<p>Once the model is trained you can use it to predict tags for new sentences. Just call the <a class="reference internal" href="../../api/generated/flair.nn.Classifier.html#flair.nn.Classifier.predict" title="flair.nn.Classifier.predict"><span class="xref myst py py-meth"><code class="docutils literal notranslate"><span class="pre">.predict()</span></code></span></a> method of the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the model you trained</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SequenceTagger</span><span class="o">.</span><span class="kp">load</span><span class="p">(</span><span class="s1">&#39;resources/taggers/example-upos/final-model.pt&#39;</span><span class="p">)</span>

<span class="c1"># create example sentence</span>
<span class="n">sentence</span> <span class="o">=</span> <span class="n">Sentence</span><span class="p">(</span><span class="s1">&#39;I love Berlin&#39;</span><span class="p">)</span>

<span class="c1"># predict tags and print</span>
<span class="n">model</span><span class="o">.</span><span class="kp">predict</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sentence</span><span class="o">.</span><span class="kp">to_tagged_string</span><span class="p">())</span>
</pre></div>
</div>
<p>If the model works well, it will correctly tag ‘love’ as a verb in this example.</p>
</section>
</section>
<section id="next">
<h2>Next<a class="headerlink" href="#next" title="Link to this heading">#</a></h2>
<p>Congrats, you now have a general overview of the main steps to train a model in Flair!</p>
<p>Next, learn about the <a class="reference internal" href="train-vs-fine-tune.html"><span class="std std-doc">two main training approaches in Flair</span></a>.</p>
</section>
</section>



                </article>
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023 Alan Akbik.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><a href="../../legal-notice/index.html">Legal notice</a></div>
      
        <div class="footer-item"><a href="https://twitter.com/alan_akbik" target="_blank">Twitter/X</a></div>
      
        <div class="footer-item"><a href="https://www.linkedin.com/in/alan-akbik-9859b1122/" target="_blank">LinkedIn</a></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>